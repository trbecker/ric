#cloud-config
ssh_pwauth: true
disable_root: true

users:
  - name: rick
    sudo: ALL=(ALL) NOPASSWD:ALL
    groups: users,admin
    home: /home/rick
    shell: /bin/bash
    lock_passwd: false
# Add your ssh key here
#    ssh-authorized-keys:
#      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC09wk3nMwVmZINZncM8TFRJumrfVxOT83o43T+h4LL ...

chpasswd:
  list: |
    rick:linux

# network configuration
hostname: aux
fqdn: aux.lan

# disks
growpart:
  mode: auto
  devices:
    - '/'

# packages
# repository keys are generated by getting the key from the internet
# and converting them to ascii
# Example:
#   # curl https://packages.cloud.google.com/apt/doc/apt-key.gpg --output /tmp/kubernetes.gpg
#   # gpg --keyring /tmp/test.gpg --no-default-keyring --import /tmp/kubernetes.gpg
#   # gpg --keyring /tmp/test.gpg --no-default-keyring --export -a

package_update: true
packages:
  - qemu-guest-agent
#  - nfs-common
#  - wget
  - git
  - linux-image-4.15.0-45-lowlatency
#  - python3-pip
#  - cmake
#  - build-essential
#  - automake
#  - autoconf
#  - pkg-config
#  - gawk
#  - libtool
#  - zlib1g-dev
#  - libffi-dev
#  - cpputest
#  - libboost-all-dev
#  - libhiredis-dev
#  - valgrind

#write_files:
#  - owner: root:root
#    permission: 644
#    path: /etc/modules.load.d/ric.conf
#    content: |
#             ip_vs
#             ip_vs_rr
#             ip_vs_wrr
#             ip_vs_sh
#             nf_conntrack_ipv4
#             nf_conntrack_ipv6
#             nf_conntrack_proto_sctp
#  - owner: root:root
#    mode: 644
#    path: /etc/netplan/01-enp3s0.yaml
#    content: |
#             network:
#                     version: 2
#                     ethernets:
#                             enp1s0:
#                                     dhcp4: no
#                                     addresses: [ 192.168.123.101/24 ]
#                                     gateway4: 192.168.123.1
#                                     nameservers:
#                                             addresses: [ 8.8.8.8, 8.8.4.4 ]

# run commands
#runcmd:
#  - touch /etc/cloud/cloud-init.disabled
#  - git clone "https://gerrit.o-ran-sc.org/r/ric-plt/appmgr" /appmgr
#  - pip3 install /appmgr/xapp_orchestrater/dev/xapp_onboarder
#  - git clone http://gerrit.o-ran-sc.org/r/it/dep /ric
#  - cd /ric && git submodule update --init --recursive --remote
#  - cd /ric/tools/k8s/bin/ && ./gen-cloud-init.sh && ./k8s-1node-cloud-init-k_1_16-h_2_17-d_cur.sh
# k8s-1node...sh will reboot the system

power_state:
  mode: reboot
